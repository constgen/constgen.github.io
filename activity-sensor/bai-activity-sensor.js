(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b():'function'==typeof define&&define.amd?define([],b):'object'==typeof exports?exports.ActivitySensor=b():a.ActivitySensor=b()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='./',b(b.s=2)}([function(a,b,c){'use strict';function d(){}function e(){f.call(this)}var f=c(6),g=f.prototype,h=Object.create(g);e.prototype=h,h.constructor=e,h.init=d,h.uninit=d,h.subscribe=function(a){g.subscribe.call(this,a),1===this.callbacks.length&&this.init()},h.unsubscribe=function(a){g.unsubscribe.call(this,a),this.callbacks.length||this.uninit()},a.exports=e},function(a){'use strict';a.exports={sum:function(a,b){return a+b},square:function(a){return Math.pow(a,2)}}},function(a,b,c){a.exports=c(3)},function(a,b,c){'use strict';function d(){this.orientationSensor=new f,this.movementSensor=new e,this.orientation=this.orientationSensor.orientation,this.movement=this.movementSensor.movement}var e=c(4),f=c(9),g=c(11),h=e.MOVEMENT_TYPE,i=f.ORIENTATION_TYPE;d.ACTIVITY_TYPE=g,d.prototype={constructor:d,get activityType(){var a=this.movement,b=this.orientation,c=a===h.FROZEN,d=a===h.STANDING,e=a===h.MOVING,f=a===h.WALKING,j=a===h.RUNNING,k=a===h.DRIVING,l=b===i.LAYING_SCREEN_DOWN,m=b===i.LAYING_SCREEN_UP,n=b===i.STANDING_PORTRAIT,o=b===i.STANDING_LANDSCAPE,p=n||o,q=b===i.WATCHED_HIGH_PORTRAIT,r=b===i.WATCHED_HIGH_LANDSCAPE,s=q||r,t=b===i.WATCHED_LOW_PORTRAIT,u=b===i.WATCHED_LOW_LANDSCAPE,v=b===i.RISED_PORTRAIT,w=b===i.RISED_LANDSCAPE,x=b===i.LIFTED;switch(!0){case(l||m)&&c:case p&&c:return g.IDLE;case p&&k:return g.IN_VEHICLE;case s&&(e||d||c):return g.SITTING;case(t||u)&&(d||e||f):case s&&f:return g.STANDING;case(v||w)&&(e||d||c):case x:return g.LAYING;case f:return g.WALKING;case j:return g.RUNNING;case k:return g.IN_VEHICLE;default:return g.UNKNOWN;}},subscribe:function(a){function b(b){'movement'in b&&(c.movement=b.movement),'orientation'in b&&(c.orientation=b.orientation),a({type:c.activityType})}var c=this;this.orientationSensor.subscribe(b),this.movementSensor.subscribe(b)},unsubscribe:function(a){a||(this.orientationSensor.unsubscribe(),this.movementSensor.unsubscribe())}},a.exports=d},function(a,b,c){'use strict';function d(){var a=this;f.call(this),this.movement=e.UNDEFINED,this.smoothHorizontal=i.lowPass(30),this.smoothVertical=i.lowPass(30),this.accumulate=i.meanArray(200),this.sensorHandler=function(b){var c=b.acceleration.x||0,d=b.acceleration.y||0,f=b.acceleration.z||0,g=b.accelerationIncludingGravity.x||0,h=b.accelerationIncludingGravity.y||0,i=b.accelerationIncludingGravity.z||0,o=[c,d,f],p=k([g,h,i],o),q=l(m(o,p)/n(j(p)),p),r=k(o,q),s=a.accumulate(o),t=j(r),u=j(q),v=j(s),w=a.smoothVertical(u),x=a.smoothHorizontal(t);a.movement=0.1>w&&0.1>x?e.FROZEN:0.5>w&&0.1>x?e.STANDING:0.5>w&&1>x||1>w&&0.5>x?e.MOVING:3>w&&2>x?e.WALKING:3<=w&&10>w&&5>x?e.RUNNING:e.UNDEFINED}}var e=c(5),f=c(0),g=c(7),h=c(1),i=c(8),j=g.magnitude,k=g.substract,l=g.multiply,m=g.dotProduct,n=h.square;d.MOVEMENT_TYPE=e,d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.init=function(){window.addEventListener('devicemotion',this.sensorHandler,!1)},d.prototype.uninit=function(){window.removeEventListener('devicemotion',this.sensorHandler,!1)},Object.defineProperties(d.prototype,{movement:{configurable:!1,enumerable:!0,get:function(){return this._movement},set:function(a){this._movement!==a&&(this._movement=a,this.emit({movement:a}))}}}),a.exports=d},function(a){'use strict';a.exports={FROZEN:'Frozen',STANDING:'Standing',MOVING:'Moving',WALKING:'Walking',RUNNING:'Running',RIDING:'Riding',DRIVING:'Driving',UNDEFINED:'Undefined'}},function(a){'use strict';function b(){this.callbacks=[]}b.prototype={constructor:b,subscribe:function(a){a&&this.callbacks.push(a)},unsubscribe:function(a){var b,c=this.callbacks;a?(b=c.indexOf(a),0<=b&&c.slice(b,1)):c.length=0},emit:function(a){for(var b=-1,c=this.callbacks;++b in c;)c[b](a)}},a.exports=b},function(a,b,c){'use strict';var d=c(1);a.exports={magnitude:function(a){var b=a.map(d.square).reduce(d.sum);return Math.sqrt(b)},substract:function(a,b){return a.map(function(a,c){return a-b[c]})},multiply:function(a,b){return a=a||0,b.map(function(b){return a*b})},dotProduct:function(a,b){return a.map(function(a,c){return a*b[c]}).reduce(d.sum)}}},function(a){'use strict';a.exports={lowPass:function(a){var b=0;return a=a||100,function(c){return b+=(c-b)/a,b}},lowPassInterval:function(a){var b=0;return a=a||100,function(c,d){return b+=d*(c-b)/a,b}},meanArray:function(a){var b=[],c=[0,0,0];return a=a||1,function(d){var e,f=b.push(d);return f>a&&(b.shift().forEach(function(a,b){c[b]-=a}),f-=1),c=d.map(function(a,b){return c[b]+a}),e=c.map(function(a){return a/f}),e}}}},function(a,b,c){'use strict';function d(){var a=this;f.call(this),this.orientation=e.UNDEFINED,this.sensorHandler=function(b){var c=b.beta,d=b.gamma;a.orientation=(170<c||-170>c||-10<c&&10>c)&&(-80>d||80<d)?e.STANDING_LANDSCAPE:80<c&&100>c&&-10<d&&10>d?e.STANDING_PORTRAIT:(175<c||-175>c)&&-5<d&&5>d?e.LAYING_SCREEN_DOWN:-5<c&&5>c&&-5<d&&5>d?e.LAYING_SCREEN_UP:(150<c||-150>c)&&-35<d&&35>d?e.LIFTED:100<=c&&-35<d&&35>d?e.RISED_PORTRAIT:(145<c||-145>c)&&(35<=d||-35>=d)?e.RISED_LANDSCAPE:30<c&&80>=c&&-30<d&&30>d?e.WATCHED_HIGH_PORTRAIT:-30<c&&30>c&&(30<=d||-30>=d)?e.WATCHED_HIGH_LANDSCAPE:5<=c&&-30<d&&30>d?e.WATCHED_LOW_PORTRAIT:-30<c&&30>c&&-30<d&&30>d?e.WATCHED_LOW_LANDSCAPE:e.UNDEFINED}}var e=c(10),f=c(0);d.ORIENTATION_TYPE=e,d.prototype=Object.create(f.prototype),d.prototype.construtcor=d,d.prototype.init=function(){window.addEventListener('deviceorientation',this.sensorHandler,!1)},d.prototype.uninit=function(){window.removeEventListener('deviceorientation',this.sensorHandler,!1)},Object.defineProperties(d.prototype,{orientation:{configurable:!1,enumerable:!0,get:function(){return this._orientation},set:function(a){this._orientation!==a&&(this._orientation=a,this.emit({orientation:a}))}}}),a.exports=d},function(a){'use strict';a.exports={LAYING_SCREEN_DOWN:'LayingScreenDown',LAYING_SCREEN_UP:'LayingScreenUp',STANDING_PORTRAIT:'StandingPortrait',STANDING_LANDSCAPE:'StandingLandscape',WATCHED_HIGH_PORTRAIT:'WatchedHighPortrait',WATCHED_HIGH_LANDSCAPE:'WatchedHighLandscape',WATCHED_LOW_PORTRAIT:'WatchedLowPortrait',WATCHED_LOW_LANDSCAPE:'WatchedLowLandscape',RISED_PORTRAIT:'RisePortrait',RISED_LANDSCAPE:'RiseLandscape',LIFTED:'Lifted',UNDEFINED:'Undefined'}},function(a){'use strict';a.exports={BIKING:'Biking',SITTING:'Sitting',STANDING:'Standing',IDLE:'Idle',IN_VEHICLE:'InVehicle',RUNNING:'Running',UNKNOWN:'Unknown',WALKING:'Walking',LAYING:'Laying'}}])});
//# sourceMappingURL=bai-activity-sensor.js.map