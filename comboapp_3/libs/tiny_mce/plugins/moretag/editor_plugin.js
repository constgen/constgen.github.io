(function(){tinymce.create("tinymce.plugins.MoreTagPlugin",{init:function(b,d){var f='<img src="'+b.theme.url+'/img/trans.gif" class="mceMoreTag mceItemNoResize" />',a="mceMoreTag",c=b.getParam("moretag_separator","<!--MORE-->"),e;e=new RegExp(c.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(g){return"\\"+g}),"g");b.addCommand("mceMoreTag",function(){b.execCommand("mceInsertContent",0,f)});b.addButton("moretag",{title:"add 'MORE...' tag",cmd:"mceMoreTag",image:d+"/img/moretag.png"});b.onInit.add(function(){if(b.theme.onResolveName){b.theme.onResolveName.add(function(g,h){if(h.node.nodeName=="IMG"&&b.dom.hasClass(h.node,a)){h.name="moretag"}})}});b.onClick.add(function(g,h){h=h.target;if(h.nodeName==="IMG"&&g.dom.hasClass(h,a)){g.selection.select(h)}});b.onNodeChange.add(function(h,g,i){g.setActive("moretag",i.nodeName==="IMG"&&h.dom.hasClass(i,a))});b.onBeforeSetContent.add(function(g,h){h.content=h.content.replace(e,f)});b.onPostProcess.add(function(g,h){if(h.get){h.content=h.content.replace(/<img[^>]+>/g,function(i){if(i.indexOf('class="mceMoreTag')!==-1){i=c}return i})}})},getInfo:function(){return{longname:"MoreTag",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/moretag",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("moretag",tinymce.plugins.MoreTagPlugin)})();